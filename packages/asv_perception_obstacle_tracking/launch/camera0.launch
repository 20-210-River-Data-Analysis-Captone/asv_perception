<?xml version="1.0" encoding="utf-8"?>
<launch>
    <arg name="pkg_name" value="asv_perception_obstacle_tracking"/>
    <arg name="ns_name" default="camera0"/>

    <group ns="$(arg ns_name)">
        <group ns="tracking">

            <!-- 
                classified obstacle tracking
            -->
            <node name="classified" pkg="$(arg pkg_name)" type="tracking.py" output="screen">
                
                <remap from="~input" to="/camera0/projection/obstacles" />

                <rosparam>
                    max_age: 4
                    min_hits: 3
                    tf_frame: 'odom'
                </rosparam>
            </node>

            <!-- 
                unclassified obstacle tracking  (unstable!)
            -->
            <!-- 
            <node name="tracking_unclassified" pkg="$(arg pkg_name)" type="tracking.py" output="screen">
                
                <remap from="~input" to="/camera0/extraction/obstacles" />

                <rosparam>
                    max_age: 6
                    min_hits: 4
                    tf_frame: 'odom'
                </rosparam>
            </node>
            -->

            <!-- combine obstacles from multiple sources into a single ObstacleArray -->
            <!-- 
            <node name="mux" pkg="$(arg pkg_name)" type="mux_obstacles.py" output="screen">

                <remap from="~input0" to="tracking_unclassified/obstacles" />
                <remap from="~input1" to="tracking_classified/obstacles" />

                <rosparam>
                    max_subs: 2
                </rosparam>
            </node>
            -->

            <!-- 
                tracked obstacle visualization
            -->
            <node name="visualization" pkg="$(arg pkg_name)" type="visualization.py" output="screen">

                <remap from="~input" to="classified/obstacles" />

                <rosparam>
                    marker_duration_secs: 0.5
                </rosparam>
            </node>

        </group>
    </group>
</launch>

