<?xml version="1.0" encoding="utf-8"?>
<launch>
    <arg name="pkg_name" value="asv_perception_fusion"/>
    <arg name="node_name" default="fusion"/>

    <group ns="left_camera">

        <arg name="topic_root_ns" default="/left_camera/$(arg node_name)/"/>

        <!-- 
            Node to consolidate known and unknown obstacle images in 2D
            Subscriptions: 
                - ~classification: [asv_perception_common/ClassificationArray] Array of detections
                - ~segmentation:   [sensor_msgs/Image] Segmented image, mono8/grayscale
            Publications:  
                - ~output: [sensor_msgs/Image] Fused classified + segmented image, mono8/grayscale
                            with pixel values as defined in ~pixel_map
            Parameters:
                - ~pixel_map:  dictionary of (string, uint8) for mapping of classification strings to pixel values
                - ~segmentation_obstacle_pixel_value:  pixel value of an obstacle in the segmentation image
        -->
        <node name="$(arg node_name)" pkg="$(arg pkg_name)" type="fusion_node.py" required="true" output="screen">

            <remap from="~segmentation" to="/left_camera/segmentation/output" />
            <remap from="~classification" to="/left_camera/classification/output" />
            <remap from="~pixel_map" to="/asv_perception/classification_pixel_map" />

            <rosparam>
                segmentation_obstacle_pixel_value: 128
            </rosparam>

        </node>

    </group>
    
</launch>

